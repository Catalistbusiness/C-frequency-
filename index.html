<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Frequency Generator</title>
    <style>
        body {
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background: #0a0a0a;
            font-family: 'Arial', sans-serif;
            color: #fff;
        }

        .container {
            text-align: center;
            padding: 20px;
            position: relative;
        }

        .language-switcher {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
        }

        .control-panel {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            max-width: 800px;
            margin: 20px;
        }

        .frequency-btn {
            padding: 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            color: white;
            transition: all 0.3s;
            background: #2c2c2c;
        }

        .frequency-btn.active {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(255,255,255,0.3);
        }

        .info-panel {
            margin: 20px;
            padding: 20px;
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            max-width: 600px;
        }

        .volume-control {
            margin: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            position: relative;
        }

        input[type="range"] {
            width: 200px;
            height: 5px;
            background: linear-gradient(to right, #4CAF50 50%, #ff4444 50%);
        }

        .volume-percent {
            width: 60px;
            text-align: center;
        }

        #volume-warning {
            position: absolute;
            top: -25px;
            right: 0;
            color: #ff4444;
            font-size: 0.8em;
            animation: pulse 1s infinite;
        }

        .presets {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }

        .preset-btn, #waveform {
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            background: #333;
            color: white;
            cursor: pointer;
        }

        #pauseBtn {
            padding: 10px 25px;
            margin: 15px;
            border: none;
            border-radius: 5px;
            background: #2196F3;
            color: white;
            cursor: pointer;
            transition: background 0.3s;
        }

        #pauseBtn.paused {
            background: #4CAF50;
        }

        #pauseBtn:disabled {
            background: #666;
            cursor: not-allowed;
        }

        @keyframes pulse {
            0% { opacity: 0.8; }
            50% { opacity: 1; }
            100% { opacity: 0.8; }
        }

        /* Frequency colors */
        .freq-111 { background: #4A148C; }
        .freq-136 { background: #311B92; }
        .freq-369 { background: #6A1B9A; }
        .freq-432 { background: #8E24AA; }
        .freq-528 { background: #AB47BC; }
        .freq-741 { background: #D81B60; }
        .freq-852 { background: #7B1FA2; }
        .freq-963 { background: #9C27B0; }
    </style>
</head>
<body>
    <div class="container">
        <div class="language-switcher">
            <button class="lang-btn" onclick="setLanguage('en')">English</button>
            <button class="lang-btn" onclick="setLanguage('am')">አማርኛ</button>
        </div>

        <h1 data-key="title">Advanced Frequency Generator</h1>
        
        <div class="presets">
            <button class="preset-btn" data-preset="meditation">Meditation</button>
            <button class="preset-btn" data-preset="focus">Focus</button>
            <button class="preset-btn" data-preset="sleep">Sleep</button>
        </div>

        <select id="waveform">
            <option value="sine">Sine</option>
            <option value="triangle" selected>Triangle</option>
            <option value="square">Square</option>
            <option value="sawtooth">Sawtooth</option>
        </select>

        <div class="control-panel">
            <button class="frequency-btn freq-111" data-freq="111">111Hz Quantum</button>
            <button class="frequency-btn freq-136" data-freq="136.1">136.1Hz Earth</button>
            <button class="frequency-btn freq-369" data-freq="369">369Hz Tesla</button>
            <button class="frequency-btn freq-432" data-freq="432">432Hz Cosmic</button>
            <button class="frequency-btn freq-528" data-freq="528">528Hz Miracle</button>
            <button class="frequency-btn freq-741" data-freq="741">741Hz Clarity</button>
            <button class="frequency-btn freq-852" data-freq="852">852Hz Intuition</button>
            <button class="frequency-btn freq-963" data-freq="963">963Hz Divine</button>
        </div>

        <div class="volume-control">
            <label data-key="volume">Volume:</label>
            <span class="volume-percent">30%</span>
            <input type="range" id="volume" min="0" max="1" step="0.05" value="0.3">
        </div>

        <button id="pauseBtn" disabled data-key="pause">Pause</button>

        <div class="info-panel" id="info" data-key="defaultInfo">
            Select a frequency to begin
        </div>
    </div>

    <script>
        const translations = {
            en: {
                title: "Advanced Frequency Generator",
                volume: "Volume:",
                pause: "Pause",
                defaultInfo: "Select a frequency to begin",
                frequencies: {
                    "111": "111Hz Quantum - Tesla's 3-6-9 theory",
                    "136": "136.1Hz Earth - Schumann resonance",
                    "369": "369Hz Tesla - Vortex mathematics",
                    "432": "432Hz Cosmic - Natural harmonics",
                    "528": "528Hz Miracle - DNA repair",
                    "741": "741Hz Clarity - Problem solving",
                    "852": "852Hz Intuition - Third eye",
                    "963": "963Hz Divine - Consciousness"
                }
            },
            am: {
                title: "የላቀ ድግግሞሽ ጀነሬተር",
                volume: "ድምጽ:",
                pause: "አቆም",
                defaultInfo: "ለመጀመር ድግግሞሽ ይምረጡ",
                frequencies: {
                    "111": "111Hz ኳንተም - ቴስላ 3-6-9 ፅንሰ ሀሳብ",
                    "136": "136.1Hz ምድር - የሽማን ድግግሞሽ",
                    "369": "369Hz ቴስላ - የቮርቴክስ ሒሳብ",
                    "432": "432Hz ኮስሞስ - ተፈጥሯዊ አርሞኒክ",
                    "528": "528Hz ተአምር - የዲ.ኤን.ኤ ጥገኛ",
                    "741": "741Hz ግልጽነት - ችግር መፍትሄ",
                    "852": "852Hz አስተውሎት - ሦስተኛ ዐይን",
                    "963": "963Hz መለኮታዊ - ኮስሞስ እውቀት"
                }
            }
        };

        let currentLanguage = 'en';

        class FrequencyGenerator {
            constructor() {
                this.audioContext = null;
                this.oscillator = null;
                this.gainNode = null;
                this.filterNode = null;
                this.currentFrequency = null;
                this.currentWaveform = 'triangle';
                this.paused = false;
                this.MAX_SAFE_VOLUME = 0.5;
                this.safetyTimers = {
                    session: null,
                    volume: null
                };

                this.presets = {
                    meditation: { freq: 432, volume: 0.3, wave: 'sine' },
                    focus: { freq: 528, volume: 0.4, wave: 'triangle' },
                    sleep: { freq: 136.1, volume: 0.2, wave: 'sine' }
                };

                this.initAudioContext();
                this.initEventListeners();
                this.updateLanguage();
            }

            initAudioContext() {
                try {
                    this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    this.createAudioNodes();
                } catch (error) {
                    this.showError("Audio API not supported");
                }
            }

            createAudioNodes() {
                this.gainNode = this.audioContext.createGain();
                this.filterNode = this.audioContext.createBiquadFilter();
                this.filterNode.type = 'lowpass';
                this.filterNode.frequency.value = 5000;
                this.gainNode.connect(this.filterNode);
                this.filterNode.connect(this.audioContext.destination);
                this.gainNode.gain.value = this.MAX_SAFE_VOLUME;
            }

            initEventListeners() {
                document.querySelectorAll('.frequency-btn').forEach(btn => {
                    btn.addEventListener('click', () => this.handleFrequency(btn.dataset.freq));
                });

                document.getElementById('volume').addEventListener('input', e => {
                    this.handleVolumeChange(e.target.value);
                });

                document.getElementById('waveform').addEventListener('change', e => {
                    this.currentWaveform = e.target.value;
                });

                document.querySelectorAll('.preset-btn').forEach(btn => {
                    btn.addEventListener('click', () => this.loadPreset(btn.dataset.preset));
                });

                document.getElementById('pauseBtn').addEventListener('click', () => this.togglePause());
            }

            togglePause() {
                if (!this.currentFrequency) return;
                
                if (this.paused) {
                    this.resume();
                } else {
                    this.pause();
                }
            }

            pause() {
                if (this.oscillator) {
                    this.oscillator.stop();
                    this.oscillator.disconnect();
                    this.oscillator = null;
                }
                this.paused = true;
                this.updateUI();
            }

            resume() {
                if (this.paused && this.currentFrequency) {
                    this.createOscillator();
                    this.paused = false;
                    this.updateUI();
                }
            }

            createOscillator() {
                this.oscillator = this.audioContext.createOscillator();
                this.oscillator.type = this.currentWaveform;
                this.oscillator.frequency.setValueAtTime(
                    this.currentFrequency, 
                    this.audioContext.currentTime
                );
                this.oscillator.connect(this.gainNode);
                this.oscillator.start();
            }

            handleFrequency(freq) {
                if (this.currentFrequency === freq) {
                    this.stop();
                } else {
                    this.play(freq);
                }
            }

            play(freq) {
                this.stop();
                this.currentFrequency = parseFloat(freq);
                this.paused = false;
                this.createOscillator();
                this.startSafetyTimer();
                this.updateUI();
            }

            stop() {
                if (this.oscillator) {
                    this.oscillator.stop();
                    this.oscillator.disconnect();
                    this.oscillator = null;
                }
                this.currentFrequency = null;
                this.paused = false;
                clearTimeout(this.safetyTimers.session);
                this.updateUI();
            }

            startSafetyTimer() {
                clearTimeout(this.safetyTimers.session);
                this.safetyTimers.session = setTimeout(() => {
                    this.stop();
                    this.showError("Automatic stop: Session limit reached");
                }, 3600000);
            }

            handleVolumeChange(value) {
                const numericValue = parseFloat(value);
                let safeValue = Math.min(numericValue, this.MAX_SAFE_VOLUME * 1.2);
                safeValue = Math.max(safeValue, 0);

                if (numericValue > this.MAX_SAFE_VOLUME) {
                    this.showVolumeWarning();
                    this.safetyTimers.volume = setTimeout(() => {
                        this.resetToSafeVolume();
                    }, 300000);
                } else {
                    clearTimeout(this.safetyTimers.volume);
                }

                if (this.gainNode) {
                    this.gainNode.gain.value = safeValue;
                    this.updateVolumeDisplay(safeValue);
                }
            }

            updateVolumeDisplay(value) {
                const percent = Math.round(value * 100);
                const safePercent = this.MAX_SAFE_VOLUME * 100;
                const color = value > this.MAX_SAFE_VOLUME ? '#ff4444' : '#4CAF50';
                
                document.getElementById('volume').style.background = 
                    `linear-gradient(to right, #4CAF50 ${safePercent}%, ${color} ${safePercent}%, ${color} 100%)`;
                
                document.querySelector('.volume-percent').textContent = `${percent}%`;
            }

            loadPreset(presetName) {
                const preset = this.presets[presetName];
                if (!preset) return;

                document.getElementById('volume').value = preset.volume;
                this.handleVolumeChange(preset.volume);
                document.getElementById('waveform').value = preset.wave;
                this.currentWaveform = preset.wave;
                this.handleFrequency(preset.freq);
            }

            updateUI() {
                document.querySelectorAll('.frequency-btn').forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.freq === String(this.currentFrequency));
                });

                const pauseBtn = document.getElementById('pauseBtn');
                pauseBtn.disabled = !this.currentFrequency;
                pauseBtn.textContent = this.paused ? 
                    translations[currentLanguage].pause.replace('Pause', 'Resume') : 
                    translations[currentLanguage].pause;

                const infoText = this.currentFrequency 
                    ? `${this.currentFrequency}Hz: ${translations[currentLanguage].frequencies[this.currentFrequency] || ''}`
                    : translations[currentLanguage].defaultInfo;
                
                document.getElementById('info').textContent = infoText;
            }

            showError(message) {
                const infoPanel = document.getElementById('info');
                infoPanel.textContent = message;
                setTimeout(() => {
                    if (!this.currentFrequency) this.updateUI();
                }, 3000);
            }

            showVolumeWarning() {
                const warning = document.createElement('div');
                warning.id = 'volume-warning';
                warning.textContent = '⚠️ ' + (currentLanguage === 'en' ? 
                    'High volume! Limit exposure' : 
                    'ከፍተኛ ድምጽ! ጊዜውን ያስቀምጡ');
                document.querySelector('.volume-control').appendChild(warning);

                setTimeout(() => warning.remove(), 3000);
            }

            resetToSafeVolume() {
                const volumeInput = document.getElementById('volume');
                volumeInput.value = this.MAX_SAFE_VOLUME;
                if (this.gainNode) {
                    this.gainNode.gain.value = this.MAX_SAFE_VOLUME;
                }
                this.showError(currentLanguage === 'en' ? 
                    "Volume reset to safe level (50%)" : 
                    "ድምጽ ወደ ደህንነቱ የተጠበቀ ደረጃ ተመልሷል (50%)");
                this.updateVolumeDisplay(this.MAX_SAFE_VOLUME);
            }
        }

        function setLanguage(lang) {
            currentLanguage = lang;
            updateLanguage();
        }

        function updateLanguage() {
            document.querySelectorAll('[data-key]').forEach(element => {
                const key = element.dataset.key;
                if (translations[currentLanguage][key]) {
                    element.textContent = translations[currentLanguage][key];
                }
            });

            document.querySelectorAll('.frequency-btn').forEach(btn => {
                const freq = btn.dataset.freq;
                if (translations[currentLanguage].frequencies[freq]) {
                    btn.textContent = translations[currentLanguage].frequencies[freq];
                }
            });

            if (window.generator) window.generator.updateUI();
        }

        document.addEventListener('DOMContentLoaded', () => {
            document.body.addEventListener('click', () => {
                if (!window.generator) {
                    window.generator = new FrequencyGenerator();
                }
            }, { once: true });
        });
    </script>
</body>
</html>
